let idx=0,chars=null,firstTry=!0;function initInput(){let charSelectButtons=document.getElementsByClassName("char-select-button");for(let btn of charSelectButtons)btn.disabled=!1,btn.addEventListener("click",submitSelection);document.addEventListener("keyup",event=>{switch(event.key){case"1":charSelectButtons[0].click();break;case"2":charSelectButtons[1].click();break;case"3":charSelectButtons[2].click();break;case"4":charSelectButtons[3].click()}})}function submitSelection(){let askedRomaji=document.getElementById("display-char").innerHTML,correctAnswer=chars.charAt(idx);if(this.value==correctAnswer){let displayChar;addToHistory(askedRomaji,correctAnswer,firstTry),idx<localStorage.getItem("string").length-1?idx++:(idx=0,chars=permute()),document.getElementById("display-char").innerHTML=getRomaji(chars.charAt(idx)).toUpperCase(),generateBtnOptions(chars.charAt(idx)),firstTry=!0,unlockButtons()}else firstTry=!1,this.disabled=!0}function unlockButtons(){let btnList=document.getElementsByClassName("char-select-button");for(let btn of btnList)btn.disabled=!1}function startPractice(charsToLearn){if(charsToLearn.length<5){document.getElementById("selection-missing").classList.remove("d-none");for(let btn of document.getElementsByClassName("char-select-button"))btn.disabled=!0;return}let displayChar=document.getElementById("display-char");askedKana=charsToLearn.charAt(idx),displayChar.innerHTML=getRomaji(askedKana).toUpperCase(),chars=charsToLearn,generateBtnOptions(askedKana)}function generateBtnOptions(askedKana){let indices=getRandIndices(),options=getThreeOptions(askedKana),btnList=document.getElementsByClassName("char-select-button");for(let i=0;i<3;i++)btnList[parseInt(indices.charAt(i))].innerHTML=options.charAt(i),btnList[parseInt(indices.charAt(i))].value=options.charAt(i);btnList[parseInt(indices.charAt(3))].innerHTML=askedKana,btnList[parseInt(indices.charAt(3))].value=askedKana}function getRomaji(askedKana){let i=0;for(;i<kana.length&&kana[i].kana!=askedKana;)i++;return kana[i].romaji}function getRandIndices(){let sortedIndices="0123",permutation="";for(;sortedIndices.length>0;){let int=sortedIndices.charAt(Math.floor(Math.random()*sortedIndices.length));sortedIndices=sortedIndices.replace(int,""),permutation+=int}return permutation}function getThreeOptions(askedKana){let options="",askedRomaji=getRomaji(askedKana);for(;options.length<3;){let randKana=chars.charAt(Math.floor(Math.random()*chars.length)),randRomaji=getRomaji(randKana);options.includes(randKana)||randRomaji==askedRomaji||(options+=randKana,randKana="")}return options}